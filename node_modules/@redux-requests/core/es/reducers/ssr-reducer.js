import defaultConfig from '../default-config';
import { getRequestActionFromResponse, isResponseAction } from '../actions';
export default (function (state, action, config) {
  var _action$meta, _action$meta2;

  if (state === void 0) {
    state = [];
  }

  if (config === void 0) {
    config = defaultConfig;
  }

  if (config.ssr === 'server' && isResponseAction(action)) {
    return [].concat(state, [getRequestActionFromResponse(action).type]);
  }

  if (config.ssr === 'client' && config.isRequestAction(action) && ((_action$meta = action.meta) != null && _action$meta.ssrResponse || (_action$meta2 = action.meta) != null && _action$meta2.ssrError)) {
    var indexToRemove = state.findIndex(function (v) {
      return v === action.type;
    });

    if (indexToRemove >= 0) {
      return state.filter(function (_, i) {
        return i !== indexToRemove;
      });
    }
  }

  return state;
});